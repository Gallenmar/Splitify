import { useState } from "react";
import { StyleSheet, View, FlatList, Button, Text } from "react-native";
import { StatusBar } from "expo-status-bar";
import { useFonts } from "expo-font";

//import GoalItem from "./components/GoalItem";
//import GoalInput from "./components/GoalInput";
import NameInput from "./components/NameInput";

export default function App() {
	const [courseGoals, setCourseGoals] = useState([]);
	const [modalIsVisible, setModalIsVisible] = useState(false);

	const [people, setPeople] = useState([]);

	function startNameInput() {
		setModalIsVisible(true);
	}

	function endNameInput() {
		setModalIsVisible(false);
	}

	function addPerson(newItem) {
		console.log(newItem);
		setPeople((prevArray) => [
			...prevArray,
			{ text: newItem, id: Math.random().toString() },
		]);
	}

	function deleteGoalHandler(id) {
		setPeople((prevCourseGoals) => {
			return prevCourseGoals.filter((goal) => goal.id !== id);
		});
	}

	const [fontsLoaded] = useFonts({
		"Roboto-Regular": require("./assets/fonts/Roboto-Regular.ttf"),
		"Roboto-Bold": require("./assets/fonts/Roboto-Bold.ttf"),
		"Sevillana-Regular": require("./assets/fonts/Sevillana-Regular.ttf"),
		"Rubik-Regular": require("./assets/fonts/RubikDoodleShadow-Regular.ttf"),
	});

	if (!fontsLoaded) {
		return undefined;
	}

	return (
		<>
			<StatusBar style="light" />
			<View style={styles.appContainer}>
				<View style={styles.topBar}>
					<View></View>
					<Text style={styles.title}>Travel Calculator</Text>
					<View style={styles.threeDot}>
						<Button title="â‹®" color={"#8a1f56"} onPress={startNameInput} />
					</View>
				</View>
				<NameInput
					visible={modalIsVisible}
					onBackPress={endNameInput}
					addPerson={addPerson}
					dataArray={people}
					setDataArray={setPeople}
					onDelete={deleteGoalHandler}
				/>
				<FlatList
					data={people}
					keyExtractor={(item) => item.id}
					renderItem={({ item }) => (
						<View style={styles.listItem}>
							<Text style={styles.itemDisplayed}>{item.text}</Text>
						</View>
					)}
				/>
			</View>
		</>
	);
}

const styles = StyleSheet.create({
	appContainer: {
		flex: 1,
		padding: 50,
		paddingHorizontal: 16,
		backgroundColor: "#3d1425",
	},
	topBar: {
		flexDirection: "row",
		justifyContent: "space-between",
	},
	title: {
		textAlign: "center",
		color: "#b03e5a",
		fontSize: 28,
	},
	threeDot: {},
	goalsContainer: {
		flex: 5,
	},
	itemDisplayed: {
		color: "white",
	},
});
